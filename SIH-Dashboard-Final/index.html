<!DOCTYPE html>
<html lang="en">

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script defer src="theme.js"></script>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="barChart.css" />
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700&display=swap" rel="stylesheet" />
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js">
  </script>
  <script src="https://d3js.org/d3.v5.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/topojson/3.0.2/topojson.min.js"
    integrity="sha256-tHoAPGoNdhIR28YHl9DWLzeRfdwigkH7OCBXMrHXhoM=" crossorigin="anonymous"></script>

  <script type="text/javascript" language="javascript">
    $(document).ready(function () {
      $('a').on('click', function () {
        var id = $(this).attr('id');
        alert(id)
        $('#container').replaceWith('The replaced text.');
      });

    });  
  </script>
</head>

<body>
  <nav class="navbar">
    <ul class="navbar-nav">
      <li class="logo" id="menu1">
        <a href="#" class="nav-link" id="menu1">
          <span class="link-text logo-text">Fireship</span>
          <svg aria-hidden="true" focusable="false" data-prefix="fad" data-icon="angle-double-right" role="img"
            xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"
            class="svg-inline--fa fa-angle-double-right fa-w-14 fa-5x">
            <g class="fa-group">
              <path fill="currentColor"
                d="M224 273L88.37 409a23.78 23.78 0 0 1-33.8 0L32 386.36a23.94 23.94 0 0 1 0-33.89l96.13-96.37L32 159.73a23.94 23.94 0 0 1 0-33.89l22.44-22.79a23.78 23.78 0 0 1 33.8 0L223.88 239a23.94 23.94 0 0 1 .1 34z"
                class="fa-secondary"></path>
              <path fill="currentColor"
                d="M415.89 273L280.34 409a23.77 23.77 0 0 1-33.79 0L224 386.26a23.94 23.94 0 0 1 0-33.89L320.11 256l-96-96.47a23.94 23.94 0 0 1 0-33.89l22.52-22.59a23.77 23.77 0 0 1 33.79 0L416 239a24 24 0 0 1-.11 34z"
                class="fa-primary"></path>
            </g>
          </svg>
        </a>
      </li>

      <li class="nav-item">
        <a href="#" class="nav-link">
          <svg aria-hidden="true" focusable="false" data-prefix="fad" data-icon="cat" role="img"
            xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="svg-inline--fa fa-cat fa-w-16 fa-9x"
            id="statewise">
            <g class="fa-group">
              <path fill="currentColor"
                d="M448 96h-64l-64-64v134.4a96 96 0 0 0 192 0V32zm-72 80a16 16 0 1 1 16-16 16 16 0 0 1-16 16zm80 0a16 16 0 1 1 16-16 16 16 0 0 1-16 16zm-165.41 16a204.07 204.07 0 0 0-34.59 2.89V272l-43.15-64.73a183.93 183.93 0 0 0-44.37 26.17L192 304l-60.94-30.47L128 272v-80a96.1 96.1 0 0 0-96-96 32 32 0 0 0 0 64 32 32 0 0 1 32 32v256a64.06 64.06 0 0 0 64 64h176a16 16 0 0 0 16-16v-16a32 32 0 0 0-32-32h-32l128-96v144a16 16 0 0 0 16 16h32a16 16 0 0 0 16-16V289.86a126.78 126.78 0 0 1-32 4.54c-61.81 0-113.52-44.05-125.41-102.4z"
                class="fa-secondary"></path>
              <path fill="currentColor"
                d="M376 144a16 16 0 1 0 16 16 16 16 0 0 0-16-16zm80 0a16 16 0 1 0 16 16 16 16 0 0 0-16-16zM131.06 273.53L192 304l-23.52-70.56a192.06 192.06 0 0 0-37.42 40.09zM256 272v-77.11a198.62 198.62 0 0 0-43.15 12.38z"
                class="fa-primary"></path>
            </g>
          </svg>
          <span class="link-text">State-Wise-Maps</span>
        </a>
      </li>

      <li class="nav-item">
        <a href="#" class="nav-link">
          <svg aria-hidden="true" focusable="false" data-prefix="fad" data-icon="alien-monster" role="img"
            xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"
            class="svg-inline--fa fa-alien-monster fa-w-18 fa-9x">
            <g class="fa-group">
              <path fill="currentColor"
                d="M560,128H528a15.99954,15.99954,0,0,0-16,16v80H480V176a15.99954,15.99954,0,0,0-16-16H416V96h48a16.00079,16.00079,0,0,0,16-16V48a15.99954,15.99954,0,0,0-16-16H432a15.99954,15.99954,0,0,0-16,16V64H368a15.99954,15.99954,0,0,0-16,16v48H224V80a15.99954,15.99954,0,0,0-16-16H160V48a15.99954,15.99954,0,0,0-16-16H112A15.99954,15.99954,0,0,0,96,48V80a16.00079,16.00079,0,0,0,16,16h48v64H112a15.99954,15.99954,0,0,0-16,16v48H64V144a15.99954,15.99954,0,0,0-16-16H16A15.99954,15.99954,0,0,0,0,144V272a16.00079,16.00079,0,0,0,16,16H64v80a16.00079,16.00079,0,0,0,16,16h48v80a16.00079,16.00079,0,0,0,16,16h96a16.00079,16.00079,0,0,0,16-16V432a15.99954,15.99954,0,0,0-16-16H192V384H384v32H336a15.99954,15.99954,0,0,0-16,16v32a16.00079,16.00079,0,0,0,16,16h96a16.00079,16.00079,0,0,0,16-16V384h48a16.00079,16.00079,0,0,0,16-16V288h48a16.00079,16.00079,0,0,0,16-16V144A15.99954,15.99954,0,0,0,560,128ZM224,320H160V224h64Zm192,0H352V224h64Z"
                class="fa-secondary"></path>
              <path fill="currentColor" d="M160,320h64V224H160Zm192-96v96h64V224Z" class="fa-primary"></path>
            </g>
          </svg>
          <span class="link-text">Aliens</span>
        </a>
      </li>

      <li class="nav-item">
        <a href="#" class="nav-link">
          <svg aria-hidden="true" focusable="false" data-prefix="fad" data-icon="space-station-moon-alt" role="img"
            xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
            class="svg-inline--fa fa-space-station-moon-alt fa-w-16 fa-5x">
            <g class="fa-group">
              <path fill="currentColor"
                d="M501.70312,224H448V160H368V96h48V66.67383A246.86934,246.86934,0,0,0,256,8C119.03125,8,8,119.0332,8,256a250.017,250.017,0,0,0,1.72656,28.26562C81.19531,306.76953,165.47656,320,256,320s174.80469-13.23047,246.27344-35.73438A250.017,250.017,0,0,0,504,256,248.44936,248.44936,0,0,0,501.70312,224ZM192,240a80,80,0,1,1,80-80A80.00021,80.00021,0,0,1,192,240ZM384,343.13867A940.33806,940.33806,0,0,1,256,352c-87.34375,0-168.71094-11.46094-239.28906-31.73633C45.05859,426.01953,141.29688,504,256,504a247.45808,247.45808,0,0,0,192-91.0918V384H384Z"
                class="fa-secondary"></path>
              <path fill="currentColor"
                d="M256,320c-90.52344,0-174.80469-13.23047-246.27344-35.73438a246.11376,246.11376,0,0,0,6.98438,35.998C87.28906,340.53906,168.65625,352,256,352s168.71094-11.46094,239.28906-31.73633a246.11376,246.11376,0,0,0,6.98438-35.998C430.80469,306.76953,346.52344,320,256,320Zm-64-80a80,80,0,1,0-80-80A80.00021,80.00021,0,0,0,192,240Zm0-104a24,24,0,1,1-24,24A23.99993,23.99993,0,0,1,192,136Z"
                class="fa-primary"></path>
            </g>
          </svg>
          <span class="link-text">Space</span>
        </a>
      </li>

      <li class="nav-item">
        <a href="#" class="nav-link">
          <svg aria-hidden="true" focusable="false" data-prefix="fad" data-icon="space-shuttle" role="img"
            xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"
            class="svg-inline--fa fa-space-shuttle fa-w-20 fa-5x">
            <g class="fa-group">
              <path fill="currentColor"
                d="M32 416c0 35.35 21.49 64 48 64h16V352H32zm154.54-232h280.13L376 168C243 140.59 222.45 51.22 128 34.65V160h18.34a45.62 45.62 0 0 1 40.2 24zM32 96v64h64V32H80c-26.51 0-48 28.65-48 64zm114.34 256H128v125.35C222.45 460.78 243 371.41 376 344l90.67-16H186.54a45.62 45.62 0 0 1-40.2 24z"
                class="fa-secondary"></path>
              <path fill="currentColor"
                d="M592.6 208.24C559.73 192.84 515.78 184 472 184H186.54a45.62 45.62 0 0 0-40.2-24H32c-23.2 0-32 10-32 24v144c0 14 8.82 24 32 24h114.34a45.62 45.62 0 0 0 40.2-24H472c43.78 0 87.73-8.84 120.6-24.24C622.28 289.84 640 272 640 256s-17.72-33.84-47.4-47.76zM488 296a8 8 0 0 1-8-8v-64a8 8 0 0 1 8-8c31.91 0 31.94 80 0 80z"
                class="fa-primary"></path>
            </g>
          </svg>
          <span class="link-text">Shuttle</span>
        </a>
      </li>

      <li class="nav-item" id="themeButton">
        <a href="#" class="nav-link">
          <svg class="theme-icon" id="lightIcon" aria-hidden="true" focusable="false" data-prefix="fad"
            data-icon="moon-stars" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
            class="svg-inline--fa fa-moon-stars fa-w-16 fa-7x">
            <g class="fa-group">
              <path fill="currentColor"
                d="M320 32L304 0l-16 32-32 16 32 16 16 32 16-32 32-16zm138.7 149.3L432 128l-26.7 53.3L352 208l53.3 26.7L432 288l26.7-53.3L512 208z"
                class="fa-secondary"></path>
              <path fill="currentColor"
                d="M332.2 426.4c8.1-1.6 13.9 8 8.6 14.5a191.18 191.18 0 0 1-149 71.1C85.8 512 0 426 0 320c0-120 108.7-210.6 227-188.8 8.2 1.6 10.1 12.6 2.8 16.7a150.3 150.3 0 0 0-76.1 130.8c0 94 85.4 165.4 178.5 147.7z"
                class="fa-primary"></path>
            </g>
          </svg>
          <svg class="theme-icon" id="solarIcon" aria-hidden="true" focusable="false" data-prefix="fad" data-icon="sun"
            role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
            class="svg-inline--fa fa-sun fa-w-16 fa-7x">
            <g class="fa-group">
              <path fill="currentColor"
                d="M502.42 240.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.41-94.8a17.31 17.31 0 0 0-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4a17.31 17.31 0 0 0 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.41-33.5 47.3 94.7a17.31 17.31 0 0 0 31 0l47.31-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3a17.33 17.33 0 0 0 .2-31.1zm-155.9 106c-49.91 49.9-131.11 49.9-181 0a128.13 128.13 0 0 1 0-181c49.9-49.9 131.1-49.9 181 0a128.13 128.13 0 0 1 0 181z"
                class="fa-secondary"></path>
              <path fill="currentColor" d="M352 256a96 96 0 1 1-96-96 96.15 96.15 0 0 1 96 96z" class="fa-primary">
              </path>
            </g>
          </svg>
          <svg class="theme-icon" id="darkIcon" aria-hidden="true" focusable="false" data-prefix="fad"
            data-icon="sunglasses" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"
            class="svg-inline--fa fa-sunglasses fa-w-18 fa-7x">
            <g class="fa-group">
              <path fill="currentColor"
                d="M574.09 280.38L528.75 98.66a87.94 87.94 0 0 0-113.19-62.14l-15.25 5.08a16 16 0 0 0-10.12 20.25L395.25 77a16 16 0 0 0 20.22 10.13l13.19-4.39c10.87-3.63 23-3.57 33.15 1.73a39.59 39.59 0 0 1 20.38 25.81l38.47 153.83a276.7 276.7 0 0 0-81.22-12.47c-34.75 0-74 7-114.85 26.75h-73.18c-40.85-19.75-80.07-26.75-114.85-26.75a276.75 276.75 0 0 0-81.22 12.45l38.47-153.8a39.61 39.61 0 0 1 20.38-25.82c10.15-5.29 22.28-5.34 33.15-1.73l13.16 4.39A16 16 0 0 0 180.75 77l5.06-15.19a16 16 0 0 0-10.12-20.21l-15.25-5.08A87.95 87.95 0 0 0 47.25 98.65L1.91 280.38A75.35 75.35 0 0 0 0 295.86v70.25C0 429 51.59 480 115.19 480h37.12c60.28 0 110.38-45.94 114.88-105.37l2.93-38.63h35.76l2.93 38.63c4.5 59.43 54.6 105.37 114.88 105.37h37.12C524.41 480 576 429 576 366.13v-70.25a62.67 62.67 0 0 0-1.91-15.5zM203.38 369.8c-2 25.9-24.41 46.2-51.07 46.2h-37.12C87 416 64 393.63 64 366.11v-37.55a217.35 217.35 0 0 1 72.59-12.9 196.51 196.51 0 0 1 69.91 12.9zM512 366.13c0 27.5-23 49.87-51.19 49.87h-37.12c-26.69 0-49.1-20.3-51.07-46.2l-3.12-41.24a196.55 196.55 0 0 1 69.94-12.9A217.41 217.41 0 0 1 512 328.58z"
                class="fa-secondary"></path>
              <path fill="currentColor"
                d="M64.19 367.9c0-.61-.19-1.18-.19-1.8 0 27.53 23 49.9 51.19 49.9h37.12c26.66 0 49.1-20.3 51.07-46.2l3.12-41.24c-14-5.29-28.31-8.38-42.78-10.42zm404-50l-95.83 47.91.3 4c2 25.9 24.38 46.2 51.07 46.2h37.12C489 416 512 393.63 512 366.13v-37.55a227.76 227.76 0 0 0-43.85-10.66z"
                class="fa-primary"></path>
            </g>
          </svg>
          <span class="link-text">Themify</span>
        </a>
      </li>
    </ul>
  </nav>

  <main>
<section>
    <div id='container'>

      <h2 id='title'> INDIA taluka level map </h2>
      <div id='description'>
        total number of Flooding events.
      </div>
      <div id='hazardtype'>
        <select name="disaster" id="disaster" onchange="drawMap()">
          <option value="EQ">Earthquake</option>
          <option value="HWV">Heat Wave</option>
          <option value="CYC">Cyclone</option>
          <option value="FL">Flood</option>
          <option value="UFL">Urban Flood</option>
          <option value="HWV">Heatwave</option>
          <option value="TSU">Tsunami</option>
          <option value="CHEM">Chemical Hazard</option>
          <option value="NUC">Nuclear Hazard</option>
          <option value="BIO">Biological Hazard</option>
        </select>
      </div>
      <div id='StateNames'>
        <select name="state" id="state" onchange="drawMap()">
          <option>Andaman and Nicobar</option>
          <option>Andhra Pradesh</option>
          <option>Arunachal Pradesh</option>
          <option>Assam</option>
          <option>Bihar</option>
          <option>Chandigarh</option>
          <option>Chhattisgarh</option>
          <option>Dadra and Nagar Haveli</option>
          <option>Daman and Diu</option>
          <option>Delhi</option>
          <option>Goa</option>
          <option>Gujarat</option>
          <option>Haryana</option>
          <option>Himachal Pradesh</option>
          <option>Jammu and Kashmir</option>
          <option>Jharkhand</option>
          <option>Karnataka</option>
          <option>Kerala</option>
          <option>Lakshadweep</option>
          <option>Madhya Pradesh</option>
          <option>Maharashtra</option>
          <option>Manipur</option>
          <option>Meghalaya</option>
          <option>Mizoram</option>
          <option>Nagaland</option>
          <option>Orissa</option>
          <option selected> Puducherry</option>
          <option>Punjab</option>
          <option>Rajasthan</option>
          <option>Sikkim</option>
          <option>Tamil Nadu</option>
          <option>Tripura</option>
          <option>Uttar Pradesh</option>
          <option>Uttaranchal</option>
          <option>West Bengal</option>

        </select>
      </div>

      <div id='tooltip'>

      </div>

      <svg id='canvas' width="950" height="600">

      </svg>

      <div id='rightSide'>
        <div id='tooltip'>

        </div>
        <svg id='legend'>
          <g>
            <rect x="10" y="0" width="40" height="40" fill="tomato"></rect>
            <text x="60" y="20" fill="black">Less than 15%</text>
          </g>
          <g>
            <rect x="10" y="40" width="40" height="40" fill="orange"></rect>
            <text x="60" y="60" fill="black">15% than 30%</text>
          </g>
          <g>
            <rect x="10" y="80" width="40" height="40" fill="lightgreen"></rect>
            <text x="60" y="100" fill="black">30% to 45%</text>
          </g>
          <g>
            <rect x="10" y="120" width="40" height="40" fill="limegreen"></rect>
            <text x="60" y="140" fill="black">More than 45%</text>
          </g>
        </svg>
        <div id='description'>Percentage of adults age 25 and older with a bachelor's degree or higher (2010-2014).
          Source: <a href='https://www.ers.usda.gov/data-products/county-level-data-sets/download-data.aspx'>USDA
            Economic Research Service</a></div>

      </div>
    
      <p> This is a sample document to test jQuery()</p>
    </div>  
<div>
  <div class="stacked-chart-container js-stacked-chart-container">
    <form class="controls">
        <label><input type="radio" name="mode" value="stacked" checked>Stacked</label>
        <label><input type="radio" name="mode" value="grouped">Grouped</label>
    </form>
    <svg class="stacked-chart js-stacked-chart"></svg>
    <div class="tooltip js-tooltip">
        <div class="tooltip-wrapper">
            <table class="tooltip-table js-tooltip-table"></table>
        </div>
    </div>
</div>

<script type="text/x-underscore" class="js-tooltip-table-content">
<table>
<% _.each(bars, function (bar) { %>
    <tr>
        <td><%= bar.name %></td>
        <td><%= bar.value %></td>
    </tr>
<% }); %>
</table>
</script>
<script src="d3.v3.min.js" charset="utf-8">
    integrity = "sha384-N8EP0Yml0jN7e0DcXlZ6rt+iqKU9Ck6f1ZQ+j2puxatnBq4k9E8Q6vqBcY34LNbn"
    crossorigin = "anonymous" ></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"
    integrity="sha384-FZY+KSLVXVyc1qAlqH9oCx1JEOlQh6iXfw3o2n3Iy32qGjXmUPWT9I0Z9e9wxYe3"
    crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.1.0.min.js"
    integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq"
    crossorigin="anonymous"></script>
<script type="text/javascript">
        "use strict";
    let disasterURLBar = 'http://localhost/sih/geo%20json/Disaster_state_district_taluka_yearwise.json'
    let diasterYearData

    /*global $, d3v3, _ */
    function drawBarChart(id) {
        var yzdata = GetYearwiseData(id)
        console.log(yzdata)
        var seriesNames = ["EQ", "FL", "CYC"],
            numSamples = 3,
            numSeries = seriesNames.length,
            data = yzdata,

            stack = d3v3.layout.stack().values(function (d) { return d.values; });
        console.log(data)

        stack(data);

        var chartMode = "stacked",
            numEnabledSeries = numSeries,
            lastHoveredBarIndex,
            containerWidth = document.querySelector(".js-stacked-chart-container").clientWidth,
            containerHeight = 500,
            margin = { top: 80, right: 30, bottom: 20, left: 30 },
            width = containerWidth - margin.left - margin.right,
            height = containerHeight - margin.top - margin.bottom,
            widthPerStack = width / numSamples,
            animationDuration = 400,
            delayBetweenBarAnimation = 10,
            numYAxisTicks = 8,
            maxStackY = d3v3.max(data, function (series) { return d3v3.max(series.values, function (d) { return d.y0 + d.y; }); }),
            paddingBetweenLegendSeries = 5,
            legendSeriesBoxX = 0,
            legendSeriesBoxY = 0,
            legendSeriesBoxWidth = 15,
            legendSeriesBoxHeight = 15,
            legendSeriesHeight = legendSeriesBoxHeight + paddingBetweenLegendSeries,
            legendSeriesLabelX = -5,
            legendSeriesLabelY = legendSeriesBoxHeight / 2,
            legendMargin = 20,
            legendX = containerWidth - legendSeriesBoxWidth - legendMargin,
            legendY = legendMargin,
            tooltipTemplate = _.template(document.querySelector(".js-tooltip-table-content").innerHTML),
            overlayTopPadding = 20,
            tooltipBottomMargin = 12;

        var binsScale = d3v3.scale.ordinal()
            .domain(d3v3.range(numSamples))
            .rangeBands([0, width], 0.1, 0.05);

        var xScale = d3v3.scale.linear()
            .domain([0, numSamples])
            .range([0, width]);

        var yScale = d3v3.scale.linear()
            .domain([0, maxStackY])
            .range([height, 0]);


        var heightScale = d3v3.scale.linear()
            .domain([0, maxStackY])
            .range([0, height]);

        var xAxis = d3v3.svg.axis()
            .scale(xScale) //binsScale)
            .ticks(numSamples)
            .orient("bottom");

        var yAxis = d3v3.svg.axis()
            .scale(yScale)
            .orient("left");

        var enabledSeries = function () { return _.reject(data, function (series) { return series.disabled; }); };

        var seriesClass = function (seriesName) { return "series-" + seriesName.toLowerCase(); };

        var layerClass = function (d) { return "layer " + seriesClass(d.name); };

        var legendSeriesClass = function (d) { return "clickable " + seriesClass(d); };

        var barDelay = function (d, i) { return i * delayBetweenBarAnimation; };

        var joinKey = function (d) { return d.name; };

        var stackedBarX = function (d) { return binsScale(d.x); };

        var stackedBarY = function (d) { return yScale(d.y0 + d.y); };

        var stackedBarBaseY = function (d) { return yScale(d.y0); };

        var stackedBarWidth = binsScale.rangeBand();

        var groupedBarX = function (d, i, j) { return binsScale(d.x) + j * groupedBarWidth(); };

        var groupedBarY = function (d) { return yScale(d.y); };

        var groupedBarBaseY = height;

        var groupedBarWidth = function () { return binsScale.rangeBand() / numEnabledSeries; };

        var barHeight = function (d) { return heightScale(d.y); };

        var transitionStackedBars = function (selection) {
            selection.transition()
                .duration(animationDuration)
                .delay(barDelay)
                .attr("y", stackedBarY)
                .attr("height", barHeight);
        };

        var svg = d3v3.select(".js-stacked-chart")
            .attr("width", containerWidth)
            .attr("height", containerHeight);

        var mainArea = svg.append("g")
            .attr("class", "main-area")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

        mainArea.append("g")
            .attr("class", "grid-lines")
            .selectAll(".grid-line").data(yScale.ticks(numYAxisTicks))
            .enter().append("line")
            .attr("class", "grid-line")
            .attr("x1", 0)
            .attr("x2", width)
            .attr("y1", yScale)
            .attr("y2", yScale);

        var layersArea = mainArea.append("g")
            .attr("class", "layers");

        var layers = layersArea.selectAll(".layer").data(data)
            .enter().append("g")
            .attr("class", layerClass);

        layers.selectAll("rect").data(function (d) { return d.values; })
            .enter().append("rect")
            .attr("x", stackedBarX)
            .attr("y", height)
            .attr("width", stackedBarWidth)
            .attr("height", 0)
            .call(transitionStackedBars);

        mainArea.append("g")
            .attr("class", "x axis")
            .attr("transform", "translate(0," + height + ")")
            .call(xAxis);

        mainArea.append("g")
            .attr("class", "y axis")
            .call(yAxis);

        svg.append("rect")
            .attr("class", "overlay")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
            .attr("x", 0)
            .attr("y", 0)
            .attr("width", width)
            .attr("height", height)
            .on("mousemove", showTooltip)
            .on("mouseout", hideTooltip);

        var legendSeries = svg.append("g")
            .attr("class", "legend")
            .attr("transform", "translate(" + legendX + "," + legendY + ")")
            .selectAll("g").data(seriesNames.reverse())
            .enter().append("g")
            .attr("class", legendSeriesClass)
            .attr("transform", function (d, i) { return "translate(0," + (i * legendSeriesHeight) + ")"; })
            .on("click", toggleSeries);

        legendSeries.append("rect")
            .attr("class", "series-box")
            .attr("x", legendSeriesBoxX)
            .attr("y", legendSeriesBoxY)
            .attr("width", legendSeriesBoxWidth)
            .attr("height", legendSeriesBoxHeight);

        legendSeries.append("text")
            .attr("class", "series-label")
            .attr("x", legendSeriesLabelX)
            .attr("y", legendSeriesLabelY)
            .text(String);


        d3v3.selectAll(".js-stacked-chart-container input").on("change", changeChartMode);

        /**
         * Toggles a certain series.
         * @param {String} seriesName The name of the series to be toggled
         */
        function toggleSeries(seriesName) {
            var series,
                isDisabling,
                newData;

            series = _.findWhere(data, { name: seriesName });
            isDisabling = !series.disabled;

            if (isDisabling === true && numEnabledSeries === 1) {
                return;
            }

            d3v3.select(this).classed("disabled", isDisabling);

            series.disabled = isDisabling;
            newData = stack(enabledSeries());
            numEnabledSeries = newData.length;
            layers = layers.data(newData, joinKey);

            if (isDisabling === true) {
                removeSeries();
            }
            else {
                addSeries();
            }
        }

        /**
         * Removes a certain series.
         */
        function removeSeries() {
            var layerToBeRemoved;

            layerToBeRemoved = layers.exit();
            if (chartMode === "stacked") {
                removeStackedSeries(layerToBeRemoved);
            }
            else {
                removeGroupedSeries(layerToBeRemoved);
            }
        }

        /**
         * Smoothly transitions and then removes a certain series when the chart is in `stacked` mode.
         * @param {d3v3.selection} layerToBeRemoved The layer that contains the series' bars
         */
        function removeStackedSeries(layerToBeRemoved) {
            layerToBeRemoved.selectAll("rect").transition()
                .duration(animationDuration)
                .delay(barDelay)
                .attr("y", stackedBarBaseY)
                .attr("height", 0)
                .call(endAll, function () {
                    layerToBeRemoved.remove();
                });

            transitionStackedBars(layers.selectAll("rect"));
        }

        /**
         * Smoothly transitions and then removes a certain series when the chart is in `grouped` mode.
         * @param {d3v3.selection} layerToBeRemoved The layer that contains the series' bars
         */
        function removeGroupedSeries(layerToBeRemoved) {
            layerToBeRemoved.selectAll("rect").transition()
                .duration(animationDuration)
                .delay(barDelay)
                .attr("y", groupedBarBaseY)
                .attr("height", 0)
                .call(endAll, function () {
                    layerToBeRemoved.remove();

                    layers.selectAll("rect").transition()
                        .duration(animationDuration)
                        .delay(barDelay)
                        .attr("x", groupedBarX)
                        .attr("width", groupedBarWidth);
                });
        }

        /**
         * Adds a certain series.
         */
        function addSeries() {
            var newLayer;

            newLayer = layers.enter().append("g")
                .attr("class", layerClass);

            if (chartMode === "stacked") {
                addStackedSeries(newLayer);
            }
            else {
                addGroupedSeries(newLayer);
            }
        }

        /**
         * Smoothly transitions and adds a certain series when the chart is in `stacked` mode.
         * @param {d3v3.selection} newLayer The new layer to be added
         */
        function addStackedSeries(newLayer) {
            newLayer.selectAll("rect").data(function (d) { return d.values; })
                .enter().append("rect")
                .attr("x", stackedBarX)
                .attr("y", stackedBarBaseY)
                .attr("width", stackedBarWidth)
                .attr("height", 0);

            transitionStackedBars(layers.selectAll("rect"));
        }

        /**
         * Smoothly transitions and adds a certain series when the chart is in `grouped` mode.
         * @param {d3v3.selection} newLayer The new layer to be added
         */
        function addGroupedSeries(newLayer) {
            var newBars;

            layers.selectAll("rect").transition()
                .duration(animationDuration)
                .delay(barDelay)
                .attr("x", groupedBarX)
                .attr("width", groupedBarWidth)
                .remove('g')
                .call(endAll, function () {
                    newBars = newLayer.selectAll("rect").data(function (d) { return d.values; })
                        .enter().append("rect")
                        .attr("y", groupedBarBaseY)
                        .attr("width", groupedBarWidth)
                        .attr("height", 0);

                    layers.selectAll("rect").attr("x", groupedBarX);

                    newBars.transition()
                        .duration(animationDuration)
                        .delay(barDelay)
                        .attr("y", groupedBarY)
                        .attr("height", barHeight);
                });
        }

        /**
         * Changes the chart to the selected mode: `stacked` or `grouped`.
         * In `stacked` mode, the bars of each bin are stacked together.
         * In `grouped` mode, the bars of each bin are placed side by side.
         */
        function changeChartMode() {
            chartMode = this.value;
            if (chartMode === "stacked") {
                stackBars();
            }
            else {
                groupBars();
            }
        }

        /**
         * Smoothly transitions the chart to `stacked` mode.
         * In this mode, the bars of each bin are stacked together.
         */
        function stackBars() {
            layers.selectAll("rect").transition()
                .duration(animationDuration)
                .delay(barDelay)
                .attr("y", stackedBarY)
                .transition()
                .duration(animationDuration)
                .attr("x", stackedBarX)
                .attr("width", stackedBarWidth);
        }

        /**
         * Smoothly transitions the chart to `grouped` mode.
         * In this mode, the bars of each bin are placed side by side.
         */
        function groupBars() {
            layers.selectAll("rect").transition()
                .duration(animationDuration)
                .delay(barDelay)
                .attr("x", groupedBarX)
                .attr("width", groupedBarWidth)
                .transition()
                .duration(animationDuration)
                .attr("y", groupedBarY);
        }

        /**
         * Shows the tooltip.
         */
        function showTooltip() {
            var hoveredBarIndex,
                tooltip;

            hoveredBarIndex = (d3v3.mouse(this)[0] / widthPerStack) | 0;
            if (hoveredBarIndex === lastHoveredBarIndex) {
                return;
            }
            lastHoveredBarIndex = hoveredBarIndex;

            layers.selectAll("rect").classed("highlighted", function (d, i) { return (i === hoveredBarIndex); });

            tooltip = $(".js-tooltip");
            tooltip.find(".js-tooltip-table").html(tooltipContent());
            tooltip.css({
                top: margin.top + highestBinBarHeight() - tooltip.outerHeight() - tooltipBottomMargin,
                left: margin.left + (hoveredBarIndex * widthPerStack) + (widthPerStack / 2) - (tooltip.outerWidth() / 2),
            }).fadeIn();
        }

        function tooltipContent() {
            var bars;

            bars = [];
            layers.each(function (d) {
                bars.unshift({ name: d.name, value: d.values[lastHoveredBarIndex].y.toFixed(4) });
            });

            return tooltipTemplate({ bars: bars });
        }

        /**
         * Hides the tooltip.
         */
        function hideTooltip() {
            $(".js-tooltip").stop().hide();

            layers.selectAll("rect")
                .filter(function (d, i) { return (i === lastHoveredBarIndex); })
                .classed("highlighted", false);

            lastHoveredBarIndex = undefined;
        }

        /**
         * Calculates the height of the highest (not tallest) bar within a certain bin.
         * @return {Number} The height, in pixels, of the highest bar within a certain bin
         */
        function highestBinBarHeight() {
            var bars,
                highestGroupBar;

            if (chartMode === "stacked") {
                highestGroupBar = _.last(layers.data()).values[lastHoveredBarIndex];
                return yScale(highestGroupBar.y0 + highestGroupBar.y);
            }
            else {
                bars = _.map(layers.data(), function (series) { return series.values[lastHoveredBarIndex]; });
                highestGroupBar = _.max(bars, function (bar) { return bar.y; });
                return yScale(highestGroupBar.y);
            }
        }

        /**
         * Calls a function at the end of **all** transitions.
         * @param {d3v3.transition} transition A D3 transition
         * @param {Function}      callback   The function to be called at the end of **all** transitions
         */
        function endAll(transition, callback) {
            var n;

            if (transition.empty()) {
                callback();
            }
            else {
                n = transition.size();
                transition.each("end", function () {
                    n--;
                    if (n === 0) {
                        callback();
                    }
                });
            }
        }

        // Inspired by Lee Byron's test data generator.
        function bumpLayer(n, o) {

            function bump(a) {
                var x = 1 / (.1 + Math.random()),
                    y = 2 * Math.random() - .5,
                    z = 10 / (.1 + Math.random());
                for (var i = 0; i < n; i++) {
                    var w = (i / n - y) * z;
                    a[i] += x * Math.exp(-w * w);
                }
            }

            var a = [], i;
            for (i = 0; i < n; ++i) a[i] = o + o * Math.random();
            for (i = 0; i < 5; ++i) bump(a);
            return a.map(function (d, i) { return { x: i, y: Math.max(0, d) }; });
        }
    }


    async function fetchData(url) {
        const response = await fetch(url);
        diasterYearData = await response.json();  // Filter Data for a fips 

        drawBarChart(334)         //draw bar chart  
    }


    fetchData(disasterURLBar)
    console.log(diasterYearData)




    // filtering data for fips 
    function GetYearwiseData(fipscode) {

        var localdata = diasterYearData.filter(function (fipsdata) {
            return fipsdata.fips === fipscode;
        });
        var YearWiseValues = []
        var values = []
        var EQ = [], FL = [], CYC = [];
        for (var i = 0; i < 3; i++) {
            EQ.push({ "x": i, "y": localdata[i].EQ, "y0": 0 })
            FL.push({ "x": i, "y": localdata[i].FL, "y0": 0 })
            CYC.push({ "x": i, "y": localdata[i].CYC, "y0": 0 })
        }

        return [{ "name": "EQ", "values": EQ }, { "name": "FL", "values": FL }, { "name": "CYC", "values": CYC }]
    }        
</script>


</div>

  </section>
  </main>
</body>
<script defer src='script.js'></script>

</html>